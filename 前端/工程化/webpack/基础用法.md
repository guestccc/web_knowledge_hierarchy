
# 基础用法

开发环境安装，通过/node_modules/.bin/webpack 比较的麻烦，通过 package.json 的 scripts 去指定一个命令进行调用

> webpack 本身是只能处理 js/json,对于 css，图片资源这些都是通过指定 loader 插件区处理的，官方就维护了很多这方面的插件


## 基本配置
  - 默认指定的是 webpack.config.js
  - 配置文件

    - entry 入口
    - output 输入
    - mode
      指定环境 process.env.NODE_ENV 和对应的一些默认插件
      development 开启 NamedChunksPlugin NamedModulesPlugin 热更新用
      production
    - module.rules-->loader
    - loader
      `loader是文件类型，babel-loader是js类型文件的js写法，es6啊，react啊，vue啊`
      webpack 开箱即用，只支持 js 和 json，通过 loader 去支持其他的文件类型，并且转成有效的模块
      本身是一个`函数`
      常用 loader
      babel-loader
      css-loader
      less-loader
      ts-loader
      file-loader 将图片，字体等的打包
      raw-loader 将文件以字符串的形式导入
      thread-loader 多进程打包 js 和 css

      use 是从右往左解析，所以是先解析 css，然后再把编译好的 css 传递给 style

    - plugins 插件

## 热更新

- watch

  - webpack --watch 需要手动刷新

  ```json
  "scripts": {
    "watch": "webpack --watch",
  },
  ```

  - watch:true
    ```js
    module.exports = {
      watch: true,
      watchOptions: {
        ignored: /node_module/,
        // 监听到变化后会等300ms再去执行，默认300ms
        aggregateTimeout: 300,
        // 每秒轮训1000次
        poll: 1000
      }
    }
    ```

- webpack-dev-server

```json
  "scripts": {
    "dev": "webpack-dev-server --open"
  },
```


## 文件指纹

- hash

hash 默认是 24 位，使用 hash:8 可以取前 8 位

  | 占位符名称  | 含义                      |
  | ----------- | ------------------------- |
  | ext         | 资源后缀名                |
  | name        | 文件名称                  |
  | path        | 文件的相对路径            |
  | folder      | 文件所在文件夹            |
  | contenthash | 文件的内容 hash，默认 md5 |
  | hash        | 文件的内容 hash，默认 md5 |
  | emoji       | 一个随机的内容 emoji      |

> 项目

- chunkhash

> 模块,不同的 entry 生产的 hash 不同 这里的 chunk 指的是模块

- contenthash

> 内容 -- extract-text-webpack-plugin 插件里的

## css压缩

```js
plugins:[
  new optimizeCssAssetsWebpackPlugin({
    assetNameRegExp: /\.css$/g,
    cssProcessor:require('cssnano')
  }),
]
```

## html压缩

```js
plugins:[
    // 该插件将为你生成一个 HTML5 文件， 其中包括使用 script 标签的 body 中的所有 webpack 包。
    new HtmlWebpackPlugin({
      template:path.join(__dirname,'src/search.html'),
      filename:'search.html',
      chunks:['search'],
      inject:true,
      minify:{
        html5:true,//根据HTML5规范解析输入
        collapseWhitespace:true,//折叠有助于文档树中文本节点的空白
        preserveLineBreaks:false,//标签之间的空格包含换行符时，请务必合拢到1个换行符（永远不要将其完全删除）。必须与collapseWhitespace=true
        minifyCSS:true,//缩小样式元素和样式属性中的CSS（使用clean-css）
        minifyJS:true,//缩小脚本元素和事件属性中的JavaScript（使用Terser）	
        removeComments:false,//删除HTML注释
      }
    }),
]
```

