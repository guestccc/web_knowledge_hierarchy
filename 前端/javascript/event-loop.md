## 进程（车间）

### 线程（员工）

## 浏览器

* 单进程

* 多子进程

  * 主进程
    * 协调控制其他子进程（创建、销毁）
    * 浏览器界面显示，用户交互，前进、后退、收藏
    * 将渲染进程得到的内存中的Bitmap，绘制到用户界面上
    * 处理不可见操作，网络请求，文件访问等
  * 第三方插件进程
    * 每种类型的插件对应一个进程，仅当使用该插件时才创建
  * GPU进程
    * 用于3D绘制等
  * 渲染进程，就是我们说的 浏览器内核
    * 负责页面渲染，脚本执行，事件处理等（多进程）
      * GUI渲染线程
        * 负责渲染页面，布局和绘制
        * 页面需要重绘和回流时，该线程就会执行
        * 与js引擎线程互斥，防止渲染结果不可预期
      * JS引擎线程--`所谓的js是一门单线程的语言`
        * 负责处理解析和执行javascript脚本程序
        * 只有一个JS引擎线程（单线程）
        * 与GUI渲染线程互斥，防止渲染结果不可预期
      * 事件触发线程
        * 用来控制事件循环（鼠标点击、setTimeout、ajax等）
        * 当事件满足触发条件时，将事件放入到JS引擎所在的执行队列中
        * 定时触发器线程
      * setInterval与setTimeout所在的线程
        * 定时任务并不是由JS引擎计时的，是由定时触发线程来计时的
        * 计时完毕后，通知事件触发线程
      * 异步http请求线程
        * 浏览器有一个单独的线程用于处理AJAX请求
        * 当请求完成时，若有回调函数，通知事件触发线程
    * 每个tab页一个渲染进程


单线程

防止同时操作dom, 在多线程不加锁的情况下，dom的渲染结果不可预期

* js引擎线程
  * 同步事件在`js引擎线程`上执行
  * 形成了执行栈---**宏任务**
  * 当前宏任务执行完，在通知gui线程前去事件触发线程的事件队列中调取微任务
  * 通知gui线程去渲染，然后读取下一个宏任务，
  * setTimeout/setInterval,`js引擎线程`通知`setTimeout/setInterval线程`
  * promise,`js引擎线程`通知`setTimeout/setInterval线程`
* setTimeout/setInterval线程---**异步http请求线程**
  * 间隔一段时间，将回调函数放入`事件触发线程`的`事件队列`
* 异步http请求线程---**微任务**
  * 请求成功后，将回调函数放入`事件触发线程`的`事件队列`
* 事件触发线程
  * 事件队列
  * js引擎线程的执行栈空闲，将异步任务添加到执行栈

宏任务(macrotask)
微任务(microtask)
